<%- partial('_partial/head') %>
<main class="container">

  <!-- ABOUT -->
  <% 
  var aboutPage = null;
  site.pages.each(function(p){
    // about 페이지 찾기 (about/index.md 기준)
    if (p.path === 'about/index.html' || (p.permalink && /\/about\/?$/.test(p.permalink))) {
      aboutPage = p;
    }
  });
  %>

  <section class="about">
    <h1>ABOUT</h1>
    <% if (aboutPage) { %>
      <div class="about-content">
        <%- aboutPage.content %>
      </div>
    <% } else { %>
      <p class="muted">/source/about/index.md 를 만들어 About 내용을 채워주세요.</p>
    <% } %>
  </section>

  <!-- PROJECTS -->
  <section class="projects">
    <h2>PROJECTS</h2>

    <% 
    // 카테고리 'Projects'인 글만 모아 최신순
    var projects = site.posts
      .filter(function(p){
        return p.categories && p.categories.toArray().some(function(c){ return c.name === 'Projects'; });
      })
      .sort('date', -1);
    %>

    <div class="projects-grid">
      <% projects.forEach(function(p){ %>
        <article class="project-card">
          <% if (p.cover) { %>
            <a href="<%- url_for(p.path) %>" class="cover">
              <img src="<%- url_for(p.cover) %>" alt="<%- p.title %>">
            </a>
          <% } %>
          <h3><a href="<%- url_for(p.path) %>"><%- p.title %></a></h3>

          <% if (p.duration) { %><p class="muted"><%= p.duration %></p><% } %>

          <% if (p.highlights && p.highlights.length) { %>
            <ul class="bullets">
              <% p.highlights.slice(0,3).forEach(function(h){ %>
                <li><%- h %></li>
              <% }); %>
            </ul>
          <% } %>

          <% if (p.stack && p.stack.length) { %>
            <p class="stack">
              <% p.stack.forEach(function(s){ %>
                <span class="badge"><%- s %></span>
              <% }); %>
            </p>
          <% } %>
        </article>
      <% }); %>
    </div>
  </section>
</main>
<%- partial('_partial/foot') %>

<style>
/* 최소 카드 스타일 (테마 톤에 맞춘 가벼운 보정) */
.projects-grid { display:grid; gap:1.25rem; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); }
.project-card { border:1px solid rgba(0,0,0,.08); padding:16px; border-radius:12px; }
.project-card .cover img { width:100%; height:160px; object-fit:cover; border-radius:8px; }
.badge { display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px; background:#eee; margin-right:6px; }
.muted { color:#777; font-size:.9em; }
.bullets { padding-left:18px; margin:8px 0; }
.about-content :is(p,ul,ol){ margin: .5em 0; }
</style>
